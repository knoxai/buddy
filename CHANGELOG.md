## V2.3.8

### 完整 Rust MCP 文件系统集成 - 显著提升文件操作性能

**核心性能优化：**
- 新增基于 Rust 的高性能文件系统操作实现
- 文件读取速度提升 2-5 倍
- 文件创建速度提升 3-10 倍  
- 目录列表速度提升 5-15 倍
- 搜索操作速度提升 10-20 倍
- 内存使用量减少约 50%
- 更好的并发处理能力

**新增工具实现：**
- ✅ **文件信息工具** (`getFileInfo`) - 获取文件/目录详细信息
- ✅ **压缩文件工具** (`zipFiles`) - 压缩多个文件为归档
- ✅ **解压文件工具** (`unzipFile`) - 解压归档文件
- ✅ **压缩目录工具** (`zipDirectory`) - 压缩整个目录
- 🦀 所有工具均提供 Rust 高性能实现和 TypeScript 回退实现

**智能混合工具系统：**
- 统一的工具界面显示，用户看到一致的工具名称
- 零配置设置，开箱即用的性能优化
- 智能环境检测（开发模式 vs VS Code 扩展环境）

**增强的回退机制：**
- 完善的 TypeScript 回退实现，确保功能完整性
- 智能参数映射：自动转换 Rust 和 TypeScript 参数格式
  - `path` ↔ `filepath`
  - `content` ↔ `contents`
  - `workingDirectory` ↔ `working_directory`
- 透明错误处理：Rust 工具失败时自动切换到 TypeScript
- 零功能损失的平滑体验

**性能监控系统：**
- 新增 `PerformanceMonitor` 实时性能跟踪
- 自动检测和记录 Rust vs TypeScript 性能差异
- 智能速度提升检测和日志记录
- 详细性能报告和分析功能
- 内存使用量监控和优化建议

**全面测试基础设施：**
- 新增 `test-rust-integration-comprehensive.js` 综合测试套件
- 二进制可用性测试（3/3 通过）
- 工具定义完整性测试（28/28 通过）
- 集成层功能测试（5/5 通过）
- 性能监控系统测试（3/3 通过）
- 100% 集成健康评分

**技术架构升级：**
- 基于 MCP (Model Context Protocol) 的通信机制
- `RustMcpIntegration` 单例管理器实现智能切换
- 混合工具架构：`createHybridTool()` 统一接口
- 工作区根目录自动检测和配置
- 环境变量 `BUDDY_WORKSPACE_ROOT` 自动设置
- 支持未来扩展更多 Rust 工具

**UI 界面集成：**
- 工具完全集成到"工具"标签页权限管理界面
- 支持可配置权限设置（自动/需要批准/停用）
- 与其他工具统一分组管理
- 自动切换机制：Rust 可用时优先使用高性能实现

**构建流程集成：**
- 依赖安装时自动构建 Rust 二进制文件
- VS Code 扩展打包时自动包含 Rust 优化
- 跨平台支持（Windows/macOS/Linux）
- 可执行文件权限自动处理

**工具完整性对比：**
```
工具类型          TypeScript  Rust   混合工具
文件读取          ✅         🦀     ✅
文件写入          ✅         🦀     ✅
目录列表          ✅         🦀     ✅
文件搜索          ✅         🦀     ✅
命令执行          ✅         🦀     ✅
文件编辑          ✅         🦀     ✅
仓库映射          ✅         🦀     ✅
文件信息          ✅         🦀     ✅
文件压缩          ✅         🦀     ✅
文件解压          ✅         🦀     ✅
目录压缩          ✅         🦀     ✅
```

此功能为文件密集型操作提供了显著的性能提升，特别适合大型代码库和频繁文件操作的开发场景，享受无缝的性能优化体验。

## V2.3.6

- 提升：用户反馈模型生成过程中的浏览体验
- 修复：Claude 4 偶尔生成空白文件

## V2.3.5

### 支持 Claude 4

## V2.3.4

### 提升模型配置UI/UX - 用户不用编辑config.yaml配置文件也可全程配置模型信息

### 提示词栏目界面优化 - 支持Monaco编辑器以便更好编辑、缩进提示词

### 增强Cursor风格特性与智能分析能力

**添加结构化推理能力：**
- 新增 `ReasoningEngine` 模块，实现类似Cursor的链式思考能力
- 添加任务分析功能，自动将复杂问题分解为简单步骤
- 支持任务复杂度智能评估：简单、中等和复杂三个层级
- 新增 `buddy.structuredSolve` 命令实现结构化问题解决流程

**增强代码导航与理解：**
- 优化 `CodeIntelligenceService`，实现智能文件导航和关联分析
- 支持跨语言的导入关系和引用检测
- 实现测试文件与源码文件的自动关联
- 添加项目结构智能分析功能，了解代码库的组织结构

**强化代码重构工具：**
- 优化 `RefactoringService` 支持安全的符号重命名和方法提取
- 支持接口提取和文件移动操作，同时自动更新导入
- 改进多文件重构时的依赖处理逻辑

**调试集成与错误修复：**
- 完善 `DebugIntegrationService` 实现调试会话分析
- 支持调用栈和变量检查，提供错误智能分析
- 自动生成错误修复建议，提高开发效率

**测试生成支持：**
- 增强 `TestGenerationService` 实现智能测试生成
- 自动检测项目使用的测试框架
- 支持基本覆盖和完整覆盖测试生成选项
- 智能处理边缘情况测试生成

**差异可视化系统：**
- 新增 `ShadowWorkspaceManager` 实现代码变更的安全预览
- 支持原始文件与AI建议修改的并排对比
- 提供简便的接受/拒绝机制，确保代码质量
- 实现临时文件的安全管理，避免意外修改

**命令历史与撤销/重做：**
- 完善 `CommandHistoryService` 实现精细的操作历史记录
- 支持操作特定的撤销/重做功能
- 添加操作历史导航功能
- 保留操作上下文，确保撤销/重做的准确性

这些新功能共同提升了插件的智能化水平，使其更接近Cursor的用户体验，同时保持了与VS Code生态系统的完美兼容。

## V2.3.2

### 提升工具调用的用户体验与准确性

添加了对流式传输期间手动滚动的检测：  
- 引入了一个新的 `userScrolledDuringStreamingRef` ref，用于跟踪用户在内容生成期间是否手动滚动  
- 修改了滚动处理逻辑，即使在流式传输期间也能检测到向上滚动  

改进了自动滚动逻辑：  
- 应用现在仅在用户未手动滚动时，在流式传输期间自动滚动  
- 当用户在内容生成期间向上滚动时，自动滚动会停止，以尊重用户阅读先前内容的意图  
- 当用户手动滚动到底部或点击滚动按钮时，自动滚动会恢复  

增强了用户界面反馈：  
- 更新了滚动指示器，显示更丰富的信息：  
  - 流式传输且用户向上滚动时：`"内容生成中... 点击返回底部"`  
  - 正常流式传输时：`"正在生成..."`  
  - 非流式传输但向上滚动时：`"点击返回底部"`  

使滚动功能更加一致：  
- 所有与滚动相关的函数现在都会考虑用户的手动滚动状态  
- 添加了逻辑以处理边缘情况，如内容调整大小、流式更新等  

## V2.3.1

### 优化对话框滚动条功能 - 自动滚动仅在模型处理生成时生效

**特殊情况的处理：**  
- 对于第一条消息，仍然会自动滚动，因为这是通常预期的行为。  
- 初始加载时仍会滚动到底部，符合直观体验。  
- 滚动指示器仅在生成内容时显示文本。  
- 助理模式在生成时仍会显示其状态指示器。  

**技术改进：**  
- 修改滚动逻辑，使其严格与流式状态绑定。  
- 简化了触发滚动的条件。  
- 移除了可能干扰用户滚动的冗余滚动尝试。  
- 使滚动更流畅、更可预测。  

**用户界面更新：**  
- 简化滚动指示器，仅在生成时显示文本。  
- 减少视觉干扰，在非生成状态时移除不必要的文本。  
- 当用户滚动离开底部时，显示指示器，方便用户轻松返回。

### 感谢[ Asianfleet ](https://github.com/Asianfleet)的 [**反馈**](https://github.com/knoxai/buddy/issues/7#issuecomment-2844014030)
> Asianfleet 您的反馈对Buddy的用户体验很有帮助，我们决定奖励您价值$20的[ **openrouter.co** ](https://openrouter.co/)全局大语言模型使用额度，请及时联系我们兑换。

## V2.3.0

- 助理支持使用Qwen3系列
- 优化聊天模式与助理模型让流式生成更顺畅
- 添加 "正在工作" 状态让插件更加细化
- 提升"助理"模式流程更倾向Cursor的处理方式
- 助理模式新增影子工作区（Shadow Workspace）功能：
  - 助理可以在隔离环境中安全地操作代码
  - 所有文件修改在应用前不会影响实际文件
  - 用户可随时应用或丢弃影子工作区中的更改
  - 支持快捷键 `Ctrl+Shift+Alt+S` 应用更改

## V2.2.8

## 新添助理模式代码诊断与静态检查

助理模式现已支持自动诊断检查和静态检查功能。
该功能确保通过助理模式修改的代码能够被正确验证语法、风格和逻辑错误。
当检测到问题时，助理将尝试自动修复，以确保生成高质量的代码。

### 自动诊断检查

- 修改任何文件后，助理模式会自动扫描语言特定的诊断问题
- 问题按严重性分类：错误、警告和信息提示
- 诊断结果通过通知和对话交互界面反馈给用户

### 智能问题修复

- 助理模式可自动尝试修复检测到的问题
- 对于复杂问题会进行多次修复尝试
- 最多尝试 3 次修复以避免无限循环
- 每次修复尝试都会记录并反馈给用户

- `buddy.checkDiagnostics` - 手动检查文件的诊断问题
- `buddy.fixDiagnostics` - 尝试修复文件中的诊断问题
- `buddy.tools/call` 配合 `fix_code_issues` - 允许助理直接修复代码问题

### 诊断系统与助理对话流程无缝集成

- 清晰的通知检测到的问题
- 详细修复尝试报告
- 无缝处理代码变更及其影响

### 工作原理

1. 当助理使用 `edit_file` 工具修改文件时，会自动运行诊断检查
2. 如果检测到问题，助理将尝试自动修复
3. 修复尝试的结果会添加到助理的上下文中
4. 用户会收到无法修复剩余问题的通知

### 使用示例

### 通过助理模式对话

您可以要求助理修复文件中的代码问题：

```
请检查并修复 src/main.tsx 中的代码问题
```

### 通过命令面板

您可以使用命令面板检查和修复问题：

1. 打开命令面板（Ctrl+Shift+P / Cmd+Shift+P）
2. 输入 "Buddy: 检查代码问题" 或 "Buddy: 修复代码问题"
3. 选择相应命令

### #技术实现

诊断系统由两个主要组件构成：

1. 与 VS Code 诊断 API 交互以检测问题
2. 管理检测到问题的修复流程

相关组件相互集成，确保与助理工作流无缝协作。

## 改进

工具调用功能的显示优化，[观看视频了解更多内容 >>](https://www.bilibili.com/video/BV1UKLzz1EmC)

## V2.2.7

- 添加文档
- 修复编辑批量接受按钮正常显示
- 修复启动应用扩展偶尔出错
- 优化启动时间
- 优化助理管理设置

## V2.2.6

## 重新设计助理模式工具调用机制

### 工具定义与注册

1. **工具实现模式：**
   - 每个工具的实现函数遵循通用模式
   - 接收参数和额外对象（如 IDE、LLM、fetch）

2. **错误处理：**
   - 工具函数包装实现，提供一致的错误处理
   - 错误被转换为用户友好的 `ContextItem` 对象
   - 记录执行时间和性能指标

### 工具执行流程

1. **工具调用机制：**
   - 执行工具的中心调度机制
   - 将工具调用路由到正确的实现或外部资源
   - 处理 HTTP 工具、MCP 工具和内置工具

2. **工具调用 Redux 流程：**
   - 发起工具调用
   - 通过 `setCalling()` 更新 UI 状态
   - 通过 `tools/call` 消息类型向 IDE 发送请求
   - 处理成功/失败并更新 UI

3. **助理模式自动化：**
   - 在助理模式下，某些工具无需用户确认即可自动执行
   - 处理助理模式下的自动工具执行
   - "安全"工具（如文件读取）在助理模式下无需确认

### 工具 UI 组件

1. **工具调用显示：**
   - 组件在聊天中渲染工具调用
   - 显示工具状态、参数和执行指标
   - 支持展开/折叠参数

2. **工具特定 UI：**
   - 某些工具有专用 UI 组件（如 `CreateFile`、`RunTerminalCommand`）
   - 通过 `FunctionSpecificToolCallDiv` 渲染

3. **工具输出：**
   - 工具结果以 `ContextItem` 对象形式渲染
   - 在 `ContextItemsPeek` 组件中显示

### 助理模式集成

1. **助理模式检测：**
   - 允许用户在聊天/助理模式间切换
   - 助理模式需要支持工具调用模型

2. **助理路由：**
   - 通过工具建议增强用户消息
   - 使用启发式方法检测何时工具可能有用
   - 在模型输入中添加提示以引导工具选择

3. **用户体验：**
   - 显示助理模式是否被启用
   - 工具设置控制哪些工具可自动执行或需要权限

### 概述

1. **工具定义分离：**
   - 工具定义（接口）与实现（逻辑）清晰分离
   - 便于添加新工具或修改现有工具

2. **错误处理：**
   - 夯实的错误处理，标准化错误格式
   - 记录所有工具执行的性能指标

3. **助理模式：**
   - 智能助理模式，平衡自动化与用户控制
   - 智能检测工具适用场景
   - "安全"工具自动执行，其他工具需用户确认

这种模块化架构使得应用程序能够轻松扩展功能，无需修改核心工具执行流程。

## 改进/修复

实现了更优的助理视图代码块处理方案：

### 1. 基于V形箭头的展开/折叠功能

实现了V形箭头的展开/折叠系统：
- 添加了小箭头指示器
- 代码块默认处于折叠状态
- 点击箭头可切换显示状态

### 2. 改进的代码块显示效果
- 优化样式，添加了适当的边框和背景
- 改进了展开/折叠的过渡动画

### 3. 状态管理优化
- 新增系统用于追踪哪些代码块处于展开状态
- 即使操作更新，状态仍会保留
- 当操作被清除时，状态会重置

### 4. 增强的可用性功能
- V形箭头的样式与应用设计语言保持一致
- 添加悬停效果以提升用户反馈
- 代码块可在容器内独立滚动
- 展开代码块时，视图会自动滚动到显示位置

### 5. 对不同操作类型的更好支持
- 统一处理不同操作类型的代码内容
- 新增支持显示命令输出
- 改进了何时显示展开控件的判断逻辑

该方案具有以下优势：

1. **导航友好**：由于代码块初始为折叠状态，用户可以轻松在操作间导航
2. **聚焦控制**：用户可自主选择展开哪些代码块，仅关注需要的内容
3. **空间高效**：界面保持紧凑，直到用户明确选择查看代码
4. **视觉一致性**：V形箭头设计与应用其他部分的语言风格统一

此改动解决了大型代码块阻碍操作间流畅导航的问题，同时保留了之前实现的所有功能。

## V2.2.4

### 提升用户添加 OpenRouter 相关 300+ 模型的用户交互体验

- 当用户选择 OpenRouter 作为提供商时，需要输入其 API 密钥。
- 一旦 API 密钥输入完成，系统会自动从 OpenRouter API 获取所有可用模型。
- 用户界面会在模型下拉菜单中显示这些模型，允许用户选择 OpenRouter 提供的任何模型。
- 选择并提交后，模型会被添加到配置中，并附带连接 OpenRouter 所需的参数。

1. 在组件中新增 OpenRouter 作为提供商选项。
2. 创建了一个实用函数，用于从 OpenRouter API 获取模型列表。
3. 实现了按提供商分类的模型分组功能。
4. 开发了一个高级模型列表组件，具备以下特性：
   - 按提供商名称分组显示
   - 仅按模型 ID 进行搜索/筛选的功能
   - 简洁的用户界面，附带上下文长度信息
   - 清晰展示模型名称和 ID

本次更新使用户能够轻松找到所需的 OpenRouter 模型：无论是通过浏览分类还是搜索特定模型 ID。

## V2.2.2

- 全新UI界面
- 全新的助理UX用户体验
- 聊天与助理设置合并
- 使用YAML作为配置文件更便捷
- 快速 聊天/助理 自由切换
- 聊天/助理 使用同一个内建向量数据库或使用远程向量数据库
- 聊天/助理 对接同一个重排序系统
- Token消耗比之前版本直降一倍
- Vite 更新至6.2.4版本
- Tailwind CSS 更新至4.0.17版本

更多新功能期待您的使用与体验中进行探索与发现

## V2.1.0

- 聊天
    - 优化配置页面更简洁、更易用
    - 暂时移除KnoxChat提供商为更强大的供应商平台做准备(已在中途)
    - 重排序处理速度更快
    - 聊天对话记录页面更易用管理记录
    - 聊天编辑模式支持添加多文件同时编辑
    - 聊天引入自动使用MCP工具
    - 强化代码库内建向量让索引更精准、打开引用行数信息更快
    - 与文件、目录、同步向量、文档索引无缝交互

- 助理
    - 新添架构师模式
    - 新添调试模式
    - 新添用户角色职能，不同模型分组配置快速切换
    - 新添提示词配置页面，让LLM工作流程更加细致与精准
    - 支持自定义上下文长度
    - 自定义是否支持图片、计算机使用与提示词缓存
    - 支持自定义输入输出价格
    - MCP工具的使用更加灵活
    - 自定义自动执行命令前缀
    - 支持无头浏览器视窗尺寸调整
    - 检查点与恢复功能更直观
    - 声效通知
    - 自定义速率限制
    - 支持 .buddyignore、.buddymodes 与 .buddyrules
    - 支持拆分完成主任务与子任务
    - 八个新添内建提示词

## V2.0.8

- 添加混合模型: DeepCode
    - DeepCode 是一个结合 Claude 3.7 Sonnet 与 DeepSeek R1 的混合模型
    - DeepSeek R1 负责推理，Claude 3.7 Sonnet 结合推理结果实现任务
    - DeepCode 混合模型能大大节省Token消耗

## V2.0.6

- 更新: 为首次使用者提供更便捷的上手步骤
- 聊天添加 Knox Chat 提供商提供以下模型
    1. Claude 3.7 Sonnet
    2. DeepSeek R1
    3. DeepSeek V3
    4. Gemini Flash 2.0
- 自动补全默认使用 Knox Chat 提供商并更新模型为:
    - Codestral 2501

## V2.0.4

- 优化自定义向量数据库的检索逻辑
- 兼容OpenAI API 提供商性能提升
- 提升节省 Knox Chat 对助理Token的消耗
- AI 助理接入 Claude 3.7 Sonnet
- AI 助理接入 Gemini Flash 2.0

## V2.0.2

- 修复自动补全偶尔空加载
- 修复向量数据库偶尔不自动检索变更

## V2.0.1

- 修复"助理"不能打开差异编辑器的问题
- 技术支持由微信变更为**JSPP**加密聊天应用 ID: 25466391

隐私聊天助技强，  
信息安全莫轻量。  
数据加密传千里，  
沟通快捷解忧忙。  

用户信息如珍宝，  
泄漏风波不可逃。  
技术护盾筑高墙，  
信任之桥稳又长。  

及时回复解疑虑，  
服务贴心暖人意。  
隐私守护如初心，  
科技助力劣优替。

## V2.0.0

- 添加Composer/助理
- 添加Knox Chat API提供商

## V1.8.0

- 优化UI
- 会话与文件交互读写
- 提升向量数据库检索速度
- 新增多文件生成与自动添加
- 跨平台扩展统一使用相同版本号

冬夜寒窗键未停，
向量田间代码耕。
索引如犁翻数据，
查询似雪覆山行。
优化枝桠修整细，
分布沟渠灌溉平。
晨光初露霜风寂，
丰收稻穗满屏盈。

## V1.7.11*

- 优化代码
- 移除不必要的模型
- 新年快乐

## V1.7.10*

- 优化整个应用的所有SVG图标
- 修复React 无法识别 DOM 元素上的属性
- 更新并提升向量数据库索引与同步速度
- 优化本地数据库SQLite
- 更新本地后端Rust所有相关库为最新版本
- 添加兼容OpenAI模型选项让用户对第三方API使用更便捷 (注：感谢来自GitHub的朋友 **fr58386612** 提供建议)

程序员对AI助手抱怨："我写的代码总是有bug。"

AI助手安慰道："别担心，bug是代码的灵魂。"

程序员："那我岂不是个灵魂画师？"

AI助手："不，你是灵魂程序员。"


## V1.7.9*

- 精修UI
- 修复自动补全配置不能打开配置文件
- 提升本地向量数据库索引速度
- 更用心的中文界面
- 最近很冷、非宅用户注意保暖！

## V1.7.8*

- 更智能的代码补全
- 右键添加文件为环境
- 支持自定义搜索，类似VS Code搜索：@Search
- @Url 通过网址获取相关Markdown文档内容
- @Postgres 获取数据表模式参考
- @Database 与数据库交互：Postgres、MySQL、MSSQL和Sqlite
- 消灭一些小虫子让整个环境宁静了许多

## V1.7.6*

- 修复发送显示重复
- 提升引用性能
- 修剪UI更简洁

## V1.7.5* 提升添加上下文环境UX(用户体验)

## Buddy: 一个帮助程序员编程的AI助理VS Code插件

Buddy旨在增强您的编码体验、简化您的工作流程并促进协作。通过集成强大的搜索和索引功能、无缝代码集成和编辑、强大的右键操作、动态聊天支持与众多LLM提供商兼容。我们旨在让开发人员(您)能够更轻松、便捷地工作，而不是需要更努力地工作。拥抱这些新功能并释放您开发过程的全部潜力。Buddy祝您编码愉快！

* 支持提供商
    - OpenAI
    - Anthropic
    - Mistral
    - Ollama
    - DeepSeek
    - KnoxChat

* 支持 .prompt 文件，保存和共享斜杠命令
* 支持仓库结构环境
* 支持 Claude 3.5 Sonnet
* Deepseek Coder v2 和其他新模型
* 通过config.json配置全局并支持注释
* 指定多个代码自动补全模型并在其间自由切换
* 支持改进的检索模型（Voyage嵌入/重排序）
* @代码库 搜索/索引整个仓库
* 用量统计
* Tab-自动补全
* 支持图片上传
* 检索的全文搜索索引
* 支持文档环境
* CodeLlama-70b
* LanceDB本地代码库同步和嵌入
* 支持LLM服务器模板
* 环境项目作为消息记录的一部分保留
* 右键支持操作
* 支持网络作为环境添加

